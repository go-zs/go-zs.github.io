---
title: golang系列(14)——类型转换
date: 2020-01-02 20:13:19
tags:
---

Golang是强类型语言，不像python可以随便给一个变量赋任意类型的值。当然，我们也经常需要用到类型转换

<!-- more -->

## 通用类型转换

* <结果类型> := <目标类型> ( <表达式> )
* 类型转换是用来在不同但相互兼容的类型之间的相互转换的方式，所以，当类型不兼容的时候，是无法转换的

```golang
var var1 int = 7
fmt.Printf("%T->%v\n", var1, var1)
var2 := float32(var1)
var3 := int64(var1)
    
*Point(p)        // same as *(Point(p))
(*Point)(p)      // p is converted to *Point
<-chan int(c)    // same as <-(chan int(c))
(<-chan int)(c)  // c is converted to <-chan int
func()(x)        // function signature func() x
(func())(x)      // x is converted to func()
(func() int)(x)  // x is converted to func() int
func() int(x)    // x is converted to func() int (unambiguous)
```

## 类型断言

* <目标类型的值>，<布尔参数> := <表达式>.( 目标类型 ) // 安全类型断言
* <目标类型的值> := <表达式>.( 目标类型 )　　//非安全类型断言 如果系统检测到不匹配，会在运行时调用内置的panic，抛出异常


```golang
func main() {
    var i interface{} = "TT"
    j, b := i.(int)
    if b {
        fmt.Printf("%T->%d\n", j, j)
    } else {
        fmt.Println("类型不匹配")
    }
}
```

## strconv包

### 字符串与整型互转

```golang
// string to int
i, err := strconv.Atoi("-42")

// int to string
s := strconv.Itoa(-42) 

// ParseInt ParseUint (s, base, bitSize)
// s：要转换的字符串
// base：进位制（2 进制到 36 进制）
// bitSize：指定整数类型（0:int、8:int8、16:int16、32:int32、64:int64）
fmt.Println(strconv.ParseInt("12345", 10, 8))
```


### 布尔值转换

```golang
fmt.Println(strconv.ParseBool("false")) // false  // 转化为bool
fmt.Println(strconv.FormatBool(0 < 1)) // true
```

### 符点数转换

```golang
f := "3.14159265"
if s, err := strconv.ParseFloat(f, 32); err == nil {
    fmt.Println(s) // 3.1415927410125732
}

// Float to string, int
s := fmt.Sprintf("%f", 123.456) // s == "123.456000"
d := fmt.Sprintf("%d", 123) // s == 123

// format float 
// string to float
// f：要转换的浮点数
// fmt：格式标记（b、e、E、f、g、G）
// prec：精度（数字部分的长度，不包括指数部分）
// bitSize：指定浮点类型（32:float32、64:float64）
f := 100.12345678901234567890123456789
fmt.Println(strconv.FormatFloat(f, 'f', 5, 32))
// 100.12346  'f'表示小数位数
fmt.Println(strconv.FormatFloat(f, 'g', 5, 32))
// 100.12
```




